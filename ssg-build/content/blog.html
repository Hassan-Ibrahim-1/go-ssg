<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link id="theme" rel="stylesheet" href="/themes/dark.css" />
        <title>a new title</title>
        <script>
            const ws = new WebSocket(`ws://${location.host}/fsevents`);
            ws.onopen = () => {
                console.log("Connected to server");
                ws.send(window.location.href);
            };

            ws.onmessage = (event) => {
                const parser = new DOMParser();
                
                const doc = parser.parseFromString(event.data, "text/html");

                const newTheme = document.getElementById("theme");
                const theme = document.getElementById("theme");

                const updatedTheme = theme.cloneNode();
                updatedTheme.href =
                    newTheme.href + "?v=" + new Date().getTime();

                updatedTheme.onload = () => theme.remove();

                theme.parentNode.insertBefore(updatedTheme, theme.nextSibling);

                document.title = doc.title;
                document.body.innerHTML = doc.body.innerHTML;
            };

            ws.onclose = () => {
                console.log("Disconnected from server");
            };
        </script>
    </head>
    <body>
        <div id="title">
            <h1>a new title</h1>
        </div>
        <div id="metadata">
            <p id="author-name"></p>
            <p id="data-published"></p>
        </div>
        <article id="main-content"><h2>Blog.md</h2>

<ul>
<li>test</li>
<li>sdfkdskf</li>
<li>asfjksdjfk</li>
</ul>

<p>[x] <strong>hey from /content/blog.md</strong></p>

<p><a href="/index.html" rel="nofollow">root</a></p>

<p><a href="/content/index.html" rel="nofollow">blog root</a></p>
</article>
    </body>
</html>
